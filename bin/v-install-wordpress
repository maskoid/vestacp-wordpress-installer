#!/bin/bash
# info: install wordpress
# options: domain install_path admin_email admin_user blog_title fname lname dbname dbuser dbpassword
#
# The function will install latest wordpress blog.
# Developed by maskoid.com vist us @ https://github.com/maskoid



#----------------------------------------------------------#
#                    Variable&Function                     #
#----------------------------------------------------------#

#Colors settings
BLUE='\033[0;34m'
GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[0;33m'
NC='\033[0m' # No Color


#Required:
#user
#domain -- select / [install/path/here]

#Admin Email
#Admin User
#log Title

#Optional
#First Name
#Last Name
#database name
#atabase user
#database password


# Argument definition

# Must Required
user=$1
domain=$2
path=$3

# Optional
admin_user=$4
admin_passwd=$5
admin_email=$6
blog_title=$7
fname=$8
lname=$9
dbname=${10}
dbuser=${11}
dbpassword=${12}
https=${13}
www=${14}

#Sample
# v-install-wordpress admin dev.maskoid.com / adminxwp adminwppasswd admain@dev.maskoid.com "Maskoid Techno" "Mohammad Azad" "Shaikh" wpdbdata wpdbuser dbpasswd yes no
# 

set_user_dir () {

	DIRECTORY=/home/$1/web/$2/public_html

	if [ -d "$DIRECTORY" ]; then
		cd $DIRECTORY
	else
		echo -e "${RED}Make sure User and Domain exist and try again!${NC}";
		exit 0
	fi
}
echo -e "\n"
echo -e "\n"
echo -e "${YELLOW}###################################################################"
echo -e "We are installing Wordpress ...."
echo -e "###################################################################"
echo -e "\n
# Must Required
$user
$domain
$path

# Optional
$admin_user
$admin_passwd
$admin_email
$blog_title
$fname
$lname
$dbname
$dbuser
$dbpassword
$https
$www
${NC}
"






#----------------------------------------------------------#
#                    Verifications                         #
#----------------------------------------------------------#


if [ ! -d "/home/$user" ]; then
    echo -e "${RED}User doesn't exist${NC}";
    exit 1;
fi

if [ ! -d "/home/$user/web/$domain/public_html" ]; then
    echo -e "${RED}Domain doesn't exist${NC}";
    exit 1;
fi







#----------------------------------------------------------#
#                       Action                             #
#----------------------------------------------------------#

WORKINGDIR="/home/$user/web/$domain/public_html$path"

echo -e "${YELLOW}Installing wordpress. Localtion${NC} $WORKINGDIR"



### Database - Start ###

echo -e -n "${YELLOW}Creating Database and DB User. ${NC}"

dbinstallresult=$(v-add-database $user $dbname $dbuser $dbpassword)

if [ -z "$dbinstallresult" ]
then
      echo "Done"
else
      echo "$dbinstallresult"
      exit 1;
fi

### Database - End ###



#----------------------------------------------------------#
#                       Vesta                              #
#----------------------------------------------------------#


#will use this when installed in nginx
